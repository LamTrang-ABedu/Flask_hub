{% extends "index.html" %}
{% block title %}Media Gallery{% endblock %}
{% block content %}
<h2>Media Gallery (Google Drive Proxy)</h2>
<select id="sourceSelect" onchange="loadGallery()">
  <option value="">-- Select Source --</option>
  <option value="redgifs">RedGifs</option>
  <option value="xvideos">Xvideos</option>
</select>

<div id="mediaGrid" class="media-grid"></div>

<script>
async function loadGallery() {
  const source = document.getElementById('sourceSelect').value;
  if (!source) return;
  const res = await fetch(`/api/media?source=${source}`);
  const data = await res.json();
  const grid = document.getElementById('mediaGrid');
  grid.innerHTML = '';

  if (data.status !== 'ok') {
    grid.innerHTML = '<p>Failed to load.</p>';
    return;
  }

  data.results.forEach(item => {
    const card = document.createElement('div');
    card.className = 'media-card';
    card.innerHTML = `
      <img src="${item.thumb}" alt="${item.title}" loading="lazy">
      <p>${item.title}</p>
      <a href="${item.video}" target="_blank">Watch</a>
    `;
    grid.appendChild(card);
  });
}
</script>
{% endblock %}