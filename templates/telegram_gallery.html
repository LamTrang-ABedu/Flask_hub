{% extends "index.html" %}
{% block title %}Telegram Media Gallery{% endblock %}
{% block content %}
<h2>Telegram Media Gallery</h2>
<div style="margin-bottom: 20px; display: flex; gap: 10px;">
  <input type="text" id="tgInput" placeholder="Enter Telegram group/channel username (e.g., @groupname)" style="flex: 1; padding: 8px;">
  <button onclick="fetchTelegramMedia()" style="width: 120px;">Fetch</button>
</div>
<div id="tgResult" style="display: grid; grid-template-columns: repeat(auto-fill, minmax(250px, 1fr)); gap: 15px;"></div>
<script>
async function fetchTelegramMedia() {
  const username = document.getElementById('tgInput').value.trim();
  const container = document.getElementById('tgResult');
  container.innerHTML = '';
  if (!username) return alert('Enter Telegram @group or channel username');
  const res = await fetch(`/api/telegram-media?group=${encodeURIComponent(username)}`);
  const data = await res.json();
  if (data.status !== 'ok') {
    container.innerHTML = `<p style="color:red;">Error: ${data.message}</p>`;
    return;
  }
  data.media.forEach(item => {
    const div = document.createElement('div');
    div.style = "border:1px solid #ccc;padding:10px;border-radius:8px;background:#fafafa";
    div.innerHTML = `<p>${item.caption || ''}</p>`;
    div.innerHTML += `<p>[${item.type.toUpperCase()} ID: ${item.file_id}]</p>`;
    container.appendChild(div);
  });
}
</script>
{% endblock %}
